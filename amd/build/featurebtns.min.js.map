{"version":3,"file":"featurebtns.min.js","sources":["../src/featurebtns.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * JavaScript to support forum + discussion feature buttons.\n *\n * @package mod_forumng\n * @copyright 2016 The Open University\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_forumng/featurebtns\n */\ndefine(['jquery', 'core/str'], function($, strings) {\n    /**\n     * Are feature buttons currently hidden by user?\n     *\n     * @type {boolean}\n     */\n    var mobileIsHidden  = true;\n    /**\n     * @alias module:mod_forumng/featurebtns\n     */\n    var t = {\n        /**\n         * Hide most feature buttons on mobile device.\n         *\n         * @public\n         */\n        initMobileHide : function() {\n            var w = $(window);\n            if (w.width() < 768) {\n                t.mobileHide();\n            }\n            $(window).on('resize', function() {\n                if (w.width() < 768 && mobileIsHidden) {\n                    t.mobileHide();\n                } else if (w.width() > 768 && mobileIsHidden) {\n                    t.mobileShow();\n                }\n            });\n        },\n\n        /**\n         * Hides feature buttons not needed on mobile.\n         * Creates a button to show them again.\n         *\n         * @private\n         */\n        mobileHide : function() {\n            if (!mobileIsHidden) {\n                /* User has already chosen to show buttons, keep on */\n                return;\n            }\n            var tohide = false;\n            $('#forumng-features:first > div form:not(.fng-mobile-on)').each(function(index, e) {\n                /* Loop so we can ignore features already disabled in CSS */\n                var el = $(e);\n                if (el.css('display') !== 'none') {\n                    el.css('display', 'none');\n                    tohide = true;\n                }\n            });\n            if (tohide) {\n                // Create button that will show the feature buttons again.\n                if ($('#forumng-features:first div.mobileshow').length) {\n                    $('#forumng-features:first > div.mobileshow').css('display', '');\n                } else {\n                    var lstring = '';\n                    var allstrings = strings.get_strings([\n                        {key: 'tooltip_show_features', component: 'mod_forumng'}\n                    ]);\n                    // Wait for promise to end.\n                    var promise = $.when(allstrings);\n                    // How we deal with promise objects is by adding callbacks.\n                    promise.done(function(langstrings) {\n                        lstring = langstrings[0];\n                    });\n                    var html = '<div class=\"mobileshow\"><form method=\"get\" action=\"#\" class=\"fng-mobile-on\">' +\n                        '<input type=\"submit\" value=\"...\"' + ' title=\"' + lstring + '\"></form></div>';\n                    // Add button after last shown on mobile button (use parents, some child-divs).\n                    $('#forumng-features:first > div form.fng-mobile-on').last().parents('div[class^=forumngfeature_]').after(html);\n                    $('#forumng-features:first div.mobileshow form input:first').on('click', function(e) {\n                        e.preventDefault();\n                        t.mobileShow();\n                        mobileIsHidden = false;\n                    });\n                }\n            }\n        },\n        /**\n         * Shows all feature buttons.\n         * Creates a button to show them again.\n         *\n         * @private\n         */\n        mobileShow : function() {\n            $('#forumng-features:first > div:not(.fng-mobile-on) form').css('display', '');\n            $('#forumng-features:first > div.mobileshow').css('display', 'none');\n        }\n    };\n    return t;\n});\n"],"names":["define","$","strings","mobileIsHidden","t","initMobileHide","w","window","width","mobileHide","on","mobileShow","tohide","each","index","e","el","css","length","lstring","allstrings","get_strings","key","component","when","done","langstrings","html","last","parents","after","preventDefault"],"mappings":";;;;;;;AA0BAA,iCAAO,CAAC,SAAU,aAAa,SAASC,EAAGC,aAMnCC,gBAAkB,EAIlBC,EAAI,CAMJC,eAAiB,eACTC,EAAIL,EAAEM,QACND,EAAEE,QAAU,KACZJ,EAAEK,aAENR,EAAEM,QAAQG,GAAG,UAAU,WACfJ,EAAEE,QAAU,KAAOL,eACnBC,EAAEK,aACKH,EAAEE,QAAU,KAAOL,gBAC1BC,EAAEO,iBAWdF,WAAa,cACJN,oBAIDS,QAAS,KACbX,EAAE,0DAA0DY,MAAK,SAASC,MAAOC,OAEzEC,GAAKf,EAAEc,GACe,SAAtBC,GAAGC,IAAI,aACPD,GAAGC,IAAI,UAAW,QAClBL,QAAS,MAGbA,UAEIX,EAAE,0CAA0CiB,OAC5CjB,EAAE,4CAA4CgB,IAAI,UAAW,QAC1D,KACCE,QAAU,GACVC,WAAalB,QAAQmB,YAAY,CACjC,CAACC,IAAK,wBAAyBC,UAAW,iBAGhCtB,EAAEuB,KAAKJ,YAEbK,MAAK,SAASC,aAClBP,QAAUO,YAAY,UAEtBC,KAAO,uHAC2CR,QAAU,kBAEhElB,EAAE,oDAAoD2B,OAAOC,QAAQ,+BAA+BC,MAAMH,MAC1G1B,EAAE,2DAA2DS,GAAG,SAAS,SAASK,GAC9EA,EAAEgB,iBACF3B,EAAEO,aACFR,gBAAiB,QAWjCQ,WAAa,WACTV,EAAE,0DAA0DgB,IAAI,UAAW,IAC3EhB,EAAE,4CAA4CgB,IAAI,UAAW,iBAG9Db"}