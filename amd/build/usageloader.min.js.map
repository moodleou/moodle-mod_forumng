{"version":3,"file":"usageloader.min.js","sources":["../src/usageloader.js"],"sourcesContent":["/**\n * Javascript module loading in forumng data.\n *\n * @module      mod_forumng/usageloader\n * @copyright   2024 Will Wise\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\n\nexport const init = (name, params) => {\n        const container = document.querySelector('.forumngusageshow' + name);\n        if (!container) {\n            return\n        }\n        let div = document.createElement(\"div\");\n        div.classList.add('ajaxworking');\n        container.append(div);\n        Ajax.call([{\n            methodname: 'mod_forumng_get_usage',\n            args: {\n                type: name,\n                param: params\n            },\n            done: function(o) {\n                if (o.responseText) {\n                    // Process the JSON data returned from the server.\n                    try {\n                        var response = JSON.parse(o.responseText);\n                        if (response.error) {\n                            usageloader_killspinner(true);\n                            return;\n                        }\n                        if (response.content) {\n                            usageloader_killspinner(false);\n                            container.innerHTML = response.content;\n                        }\n                    } catch (e) {\n                        usageloader_killspinner(true);\n                        return;\n                    }\n                } else {\n                    usageloader_killspinner(true);\n                    return;\n                }\n            },\n            fail: function () {\n                usageloader_killspinner(true);\n            }\n        }]);\n\n        var usageloader_killspinner = function(failed) {\n            var spinner = container.querySelector('.ajaxworking');\n            if (spinner) {\n                spinner.remove(true);\n            }\n            if (failed) {\n                // Show noajax load link.\n                var noscript = container.querySelector('.forumngusage_loader_noscript');\n                if (noscript) {\n                    noscript.style.display = 'block';\n                }\n            }\n        };\n    }"],"names":["name","params","container","document","querySelector","div","createElement","classList","add","append","call","methodname","args","type","param","done","o","responseText","response","JSON","parse","error","usageloader_killspinner","content","innerHTML","e","fail","failed","spinner","remove","noscript","style","display"],"mappings":";;;;;;;oJAUoB,CAACA,KAAMC,gBACbC,UAAYC,SAASC,cAAc,oBAAsBJ,UAC1DE,qBAGDG,IAAMF,SAASG,cAAc,OACjCD,IAAIE,UAAUC,IAAI,eAClBN,UAAUO,OAAOJ,mBACZK,KAAK,CAAC,CACPC,WAAY,wBACZC,KAAM,CACFC,KAAMb,KACNc,MAAOb,QAEXc,KAAM,SAASC,MACPA,EAAEC,qBAGMC,SAAWC,KAAKC,MAAMJ,EAAEC,iBACxBC,SAASG,kBACTC,yBAAwB,GAGxBJ,SAASK,UACTD,yBAAwB,GACxBpB,UAAUsB,UAAYN,SAASK,SAErC,MAAOE,eACLH,yBAAwB,QAI5BA,yBAAwB,IAIhCI,KAAM,WACFJ,yBAAwB,WAI5BA,wBAA0B,SAASK,YAC/BC,QAAU1B,UAAUE,cAAc,mBAClCwB,SACAA,QAAQC,QAAO,GAEfF,OAAQ,KAEJG,SAAW5B,UAAUE,cAAc,iCACnC0B,WACAA,SAASC,MAAMC,QAAU"}