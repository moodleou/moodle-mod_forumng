{"version":3,"file":"mod_form.min.js","sources":["../src/mod_form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * A javascript module to enhance the mod form.\n *\n * @package mod_forumng\n * @copyright 2023 The Open University\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const init = (formId, timeTracking) => {\n    const form = document.getElementById(formId);\n    const timeTrackingFrom = document.querySelector('#id_timetrackingfrom_enabled');\n    const timeTrackingTo = document.querySelector('#id_timetrackingto_enabled');\n    if (timeTracking.timetrackingfrom === '0') {\n        timeTrackingFrom.checked = false;\n    }\n    if (timeTracking.timetrackingto === '0') {\n        timeTrackingTo.checked = false;\n    }\n    completionForm(form);\n};\n\n/**\n * Listens when the user changes the required conditions in completion\n * and toggle wordcount min max option and enable/disable the tracking time.\n *\n * @param {HTMLElement} formElement The root form element.\n */\nconst completionForm = (formElement) => {\n    const forumngCompletionRequire = formElement.querySelectorAll('.forumng-completion-require:checked');\n    const allRequirements = document.querySelector('#id_completion_2, #id_completion_forumng_2');\n    if (!forumngCompletionRequire.length) {\n        toggleHiddenClassWordcount(true);\n        allRequirements.addEventListener('change', function() {\n            if (allRequirements.checked) {\n                enableDisableTrackingTime(true);\n            }\n        });\n    }\n\n    formElement.querySelectorAll('input.forumng-completion-require').forEach(item => {\n        item.addEventListener('change', function() {\n            const forumngCompletionRequire = formElement.querySelectorAll('.forumng-completion-require:checked');\n            if (forumngCompletionRequire.length > 0) {\n                toggleHiddenClassWordcount(false);\n                enableDisableTrackingTime(false);\n            } else {\n                toggleHiddenClassWordcount(true);\n                enableDisableTrackingTime(true);\n            }\n        });\n    });\n};\n\n\n/**\n * Show/hide wordcount group.\n *\n * @param {Boolean} status hidden status.\n */\nconst toggleHiddenClassWordcount = (status) => {\n    const fgroupWordcountMin = document.querySelector('#fgroup_id_completionwordcountmingroup,' +\n        '#fgroup_id_completionwordcountmingroup_forumng');\n    const fgroupWordcountMax = document.querySelector('#fgroup_id_completionwordcountmaxgroup,' +\n        '#fgroup_id_completionwordcountmaxgroup_forumng');\n    if (status) {\n        fgroupWordcountMin.classList.add('hidden');\n        fgroupWordcountMax.classList.add('hidden');\n    } else {\n        fgroupWordcountMin.classList.remove('hidden');\n        fgroupWordcountMax.classList.remove('hidden');\n    }\n};\n\n/**\n * Enables or disables the \"From\" and \"To\" time tracking input fields.\n *\n * @param {Boolean} status\n */\nconst enableDisableTrackingTime = (status) => {\n    const timeTrackingFrom = document.querySelector('#id_timetrackingfrom_enabled, #id_timetrackingfrom_forumng_enabled');\n    const timeTrackingTo = document.querySelector('#id_timetrackingto_enabled, #id_timetrackingto_forumng_enabled');\n    const timeTrackingSelects = document.querySelectorAll('select[id^=\"id_timetracking\"]');\n    if (status) {\n        timeTrackingFrom.disabled = true;\n        timeTrackingTo.disabled = true;\n        timeTrackingFrom.checked = false;\n        timeTrackingTo.checked = false;\n        timeTrackingSelects.forEach(element => {\n            if (element.disabled !== true) {\n                element.disabled = true;\n            }\n        });\n    } else {\n        const timeTrackingSelectsFrom = document.querySelectorAll('select[id^=\"id_timetrackingfrom\"]');\n        const timeTrackingSelectsTo = document.querySelectorAll('select[id^=\"id_timetrackingto\"]');\n        // Since datetime selections are disabled when the status is true, we should check and enable them when false.\n        timeTrackingFrom.addEventListener('change', function() {\n            if (timeTrackingFrom.checked) {\n                timeTrackingSelectsFrom.forEach(element => {\n                    element.disabled = false;\n                });\n            }\n        });\n        timeTrackingTo.addEventListener('change', function() {\n            if (timeTrackingTo.checked) {\n                timeTrackingSelectsTo.forEach(element => {\n                    element.disabled = false;\n                });\n            }\n        });\n        timeTrackingFrom.disabled = false;\n        timeTrackingTo.disabled = false;\n    }\n};\n"],"names":["_exports","init","formId","timeTracking","form","document","getElementById","timeTrackingFrom","querySelector","timeTrackingTo","timetrackingfrom","checked","timetrackingto","completionForm","formElement","forumngCompletionRequire","querySelectorAll","allRequirements","length","toggleHiddenClassWordcount","addEventListener","enableDisableTrackingTime","forEach","item","status","fgroupWordcountMin","fgroupWordcountMax","classList","add","remove","timeTrackingSelects","disabled","element","timeTrackingSelectsFrom","timeTrackingSelectsTo"],"mappings":"2IAkCEA,SAAAC,KAXkBA,CAACC,OAAQC,gBACzB,MAAMC,KAAOC,SAASC,eAAeJ,QAC/BK,iBAAmBF,SAASG,cAAc,gCAC1CC,eAAiBJ,SAASG,cAAc,8BACR,MAAlCL,aAAaO,mBACbH,iBAAiBI,SAAU,GAEK,MAAhCR,aAAaS,iBACbH,eAAeE,SAAU,GAE7BE,eAAeT,KAAK,EASxB,MAAMS,eAAkBC,cACpB,MAAMC,yBAA2BD,YAAYE,iBAAiB,uCACxDC,gBAAkBZ,SAASG,cAAc,8CAC1CO,yBAAyBG,SAC1BC,4BAA2B,GAC3BF,gBAAgBG,iBAAiB,UAAU,WACnCH,gBAAgBN,SAChBU,2BAA0B,EAElC,KAGJP,YAAYE,iBAAiB,oCAAoCM,SAAQC,OACrEA,KAAKH,iBAAiB,UAAU,WACKN,YAAYE,iBAAiB,uCACjCE,OAAS,GAClCC,4BAA2B,GAC3BE,2BAA0B,KAE1BF,4BAA2B,GAC3BE,2BAA0B,GAElC,GAAE,GACJ,EASAF,2BAA8BK,SAChC,MAAMC,mBAAqBpB,SAASG,cAAc,yFAE5CkB,mBAAqBrB,SAASG,cAAc,yFAE9CgB,QACAC,mBAAmBE,UAAUC,IAAI,UACjCF,mBAAmBC,UAAUC,IAAI,YAEjCH,mBAAmBE,UAAUE,OAAO,UACpCH,mBAAmBC,UAAUE,OAAO,UACxC,EAQER,0BAA6BG,SAC/B,MAAMjB,iBAAmBF,SAASG,cAAc,sEAC1CC,eAAiBJ,SAASG,cAAc,kEACxCsB,oBAAsBzB,SAASW,iBAAiB,iCACtD,GAAIQ,OACAjB,iBAAiBwB,UAAW,EAC5BtB,eAAesB,UAAW,EAC1BxB,iBAAiBI,SAAU,EAC3BF,eAAeE,SAAU,EACzBmB,oBAAoBR,SAAQU,WACC,IAArBA,QAAQD,WACRC,QAAQD,UAAW,EACvB,QAED,CACH,MAAME,wBAA0B5B,SAASW,iBAAiB,qCACpDkB,sBAAwB7B,SAASW,iBAAiB,mCAExDT,iBAAiBa,iBAAiB,UAAU,WACpCb,iBAAiBI,SACjBsB,wBAAwBX,SAAQU,UAC5BA,QAAQD,UAAW,CAAK,GAGpC,IACAtB,eAAeW,iBAAiB,UAAU,WAClCX,eAAeE,SACfuB,sBAAsBZ,SAAQU,UAC1BA,QAAQD,UAAW,CAAK,GAGpC,IACAxB,iBAAiBwB,UAAW,EAC5BtB,eAAesB,UAAW,CAC9B,EACF"}